From Dave Hill <ddhill@zk3.dec.com>:
-----------------------------------

DEC OSF1/AXP extra notes:
=========================

To build this library, add -std1 to cc line in Makefile after running
configure:

# default c-compiler
CC = cc -std1

To create a shared library from the static library:

ld -shared -o libmalloc_dbg.so -all libmalloc_dbg.a -all \
	-soname libmalloc_dbg.so -none -lc
	

The OSF1/AXP shared library loader has the capabilities to override the
shared libraries used, even to the extent that it takes symbols from a
library that the program was not linked with.  Using this technique, you
may override the standard malloc in libc with the debug malloc shared
library.

 _RLD_LIST=/path_to_the_dir/libmalloc_dbg.so:DEFAULT;export _RLD_LIST

Remember though, setting this variable will affect ALL commands invoked
from the shell that it is set inside of.  You may wish to do this inside
of a shell script that sets the variable just before starting your
program.  Another option with sh and ksh is to list the environment
variables on the program invocation line, for example:

_RLD_LIST=/path_to_the_dir/libmalloc_dbg.so:DEFAULT program

This command will set the specified env variable and then run program.

-------------------------------------------------------------------------------

OSF1 also supports the use of an 'init' and a 'fini' routine. Any function
prefixed with '__init_' will be executed prior to main() and any function
prefixed with '__fini_' will be executed after any call to exit() or
after main() returns.

A fini routine can be used with the debug library to invoke malloc_shutdown
to get final statistics from the library package. For example:

void
__fini_mallocdbg()
{
    malloc_shutdown();
}

Try putting this code in a separate .o file and linking it into your
application when you are debugging.
